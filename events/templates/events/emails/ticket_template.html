<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ticket - {{ event.title }}</title>
    <style>
        /* Table-based layout for reliable PDF rendering (xhtml2pdf compatible) */
        @page { size: A4; margin: 15mm }
        body { font-family: Arial, Helvetica, sans-serif; color:#222; font-size:13px; background:#fff; }
        .outer { width:100%; max-width:800px; margin:0 auto; }
        .ticket-box { border:1px solid #dfe6ee; border-radius:6px; overflow:hidden; }
        .banner { background-color:#0b69ff; color:#ffffff; padding:14px 16px; }
        .brand { font-size:18px; font-weight:700; }
        .banner-sub { font-size:11px; opacity:0.95; margin-top:4px; }
        table.layout { width:100%; border-collapse:collapse; }
        td.left { width:65%; vertical-align:top; padding:18px; }
        td.right { width:35%; vertical-align:top; padding:18px; border-left:1px solid #eef2f6; text-align:center; }
        .event-title { font-size:18px; font-weight:700; margin:0 0 6px 0; }
        .when, .where, .organizer, .mode { font-size:12px; color:#4b5563; margin:4px 0; }
        .label { display:block; font-size:11px; color:#6b7280; }
        .value { font-weight:700; color:#0f172a; font-size:13px; }
        .qr-img { width:160px; height:160px; display:block; margin:8px auto; border:4px solid #ffffff; }
        .attendee { font-size:14px; font-weight:700; margin-top:8px; }
        .regid { font-size:11px; color:#7b8794; margin-top:6px; }
        .notes { font-size:11px; color:#6b7280; margin-top:12px; }
        .footer { padding:12px 16px; border-top:1px solid #f1f5f9; font-size:11px; color:#6b7280; }
        .small { font-size:10px; color:#98a0ad }
    </style>
</head>
<body>
    <div class="outer">
        <div class="ticket-box">
            <div class="banner">
                <div class="brand">College Event Hub</div>
                <div class="banner-sub">Official Ticket — Please bring this to the event</div>
            </div>

            <table class="layout">
                <tr>
                    <td class="left">
                        <div class="event-title">{{ event.title }}</div>

                        <div class="when">
                            <span class="label">Starts</span>
                            <div class="value">{% if event.start_time %}{{ event.start_time|date:"l, d F Y" }} at {{ event.start_time|time:"H:i" }}{% else %}TBA{% endif %}</div>
                        </div>

                        <div class="when">
                            <span class="label">Ends</span>
                            <div class="value">{% if event.end_time %}{{ event.end_time|date:"l, d F Y" }} at {{ event.end_time|time:"H:i" }}{% else %}—{% endif %}</div>
                        </div>

                        <div class="where">
                            <span class="label">Location</span>
                            <div class="value">{% if event.location %}{{ event.location }}{% else %}Online / See event page{% endif %}</div>
                        </div>

                        <div class="mode">
                            <span class="label">Mode</span>
                            <div class="value">{{ event.event_mode|default:"Online" }}</div>
                        </div>

                        <div class="organizer">
                            <span class="label">Organizer</span>
                            <div class="value">{{ event.organizer.get_full_name|default:event.organizer.username }}{% if event.organizer.email %} — {{ event.organizer.email }}{% endif %}</div>
                        </div>

                        <div class="notes">
                            Please present this ticket (or the attached PDF) at the check-in desk. This ticket is non-transferable and will be verified using the QR code.
                        </div>
                    </td>

                    <td class="right">
                        {% if qr_code_path %}
                            <img src="{{ qr_code_path }}" alt="QR Code" class="qr-img" />
                        {% else %}
                            <div style="width:160px;height:160px;background:#f1f5f9;margin:8px auto;line-height:160px;color:#9aa4b3;">No QR</div>
                        {% endif %}

                        <div class="attendee">{{ registration.attendee.get_full_name|default:registration.attendee.username }}</div>
                        <div class="regid">Registration ID: REG-{{ registration.id }}</div>

                        <div style="margin-top:10px; font-size:11px; color:#627383;">
                            <div>Seat: {{ registration.seat_number|default:"N/A" }}</div>
                        </div>
                    </td>
                </tr>
            </table>

            <div class="footer">
                Event page: {{ event_url }}
                <div class="small">If you have any issues, contact the organizer or reply to this email.</div>
            </div>
        </div>
    </div>
</body>
</html>

